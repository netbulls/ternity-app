<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Working Hours — V4 Compact Cards (App Chrome)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Oxanium:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../themes.css" />
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
      *,
      *::before,
      *::after {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html,
      body {
        height: 100%;
        overflow: hidden;
      }

      body {
        font-family: 'Inter', system-ui, sans-serif;
        font-size: 14px;
      }

      /* ── Theme switcher (outside app chrome) ── */
      .theme-bar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 100;
        display: flex;
        justify-content: center;
        gap: 4px;
        padding: 6px 16px;
        background: rgba(10, 10, 10, 0.92);
        backdrop-filter: blur(8px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.06);
      }
      .theme-bar button {
        font-family: 'Inter', sans-serif;
        font-size: 10px;
        padding: 3px 10px;
        border-radius: 4px;
        border: 1px solid #222;
        background: #161616;
        color: rgba(255, 255, 255, 0.35);
        cursor: pointer;
        transition: all 0.15s;
      }
      .theme-bar button:hover {
        border-color: #444;
      }
      .theme-bar button.active {
        background: #333;
        border-color: #555;
        color: rgba(255, 255, 255, 0.8);
      }

      /* ── App shell ── */
      #app {
        display: flex;
        height: 100vh;
        padding-top: 32px; /* space for theme bar */
      }

      /* ── Sidebar ── */
      .sidebar {
        width: 220px;
        flex-shrink: 0;
        background: hsl(var(--sidebar-background));
        border-right: 1px solid hsl(var(--sidebar-border));
        display: flex;
        flex-direction: column;
        padding: 20px 12px;
        color: hsl(var(--sidebar-foreground));
        overflow-y: auto;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 0 10px;
        margin-bottom: 20px;
      }
      .logo-icon {
        width: 18px;
        height: 22px;
        color: hsl(var(--primary));
      }
      .logo-text {
        font-family: 'Oxanium', sans-serif;
        font-size: 15px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 3px;
      }

      .section-label {
        padding: 8px 10px 4px;
        font-family: 'Oxanium', sans-serif;
        text-transform: uppercase;
        color: hsl(var(--muted-foreground));
        opacity: 0.5;
        font-size: 9px;
        letter-spacing: 2px;
      }

      .nav-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 8px 10px;
        border-radius: 6px;
        color: hsl(var(--muted-foreground));
        font-size: 13px;
        cursor: pointer;
        transition: all 0.15s;
        text-decoration: none;
      }
      .nav-item:hover {
        background: hsl(var(--sidebar-accent));
        color: hsl(var(--sidebar-accent-foreground));
      }
      .nav-item i {
        width: 16px;
        height: 16px;
      }

      .sidebar-spacer {
        flex: 1;
      }

      /* User block */
      .user-block {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px 10px;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.15s;
      }
      .user-block:hover {
        background: hsl(var(--muted) / 0.5);
      }
      .avatar {
        width: 32px;
        height: 32px;
        border-radius: 8px;
        background: hsl(var(--t-avatar-bg));
        color: hsl(var(--t-avatar-text));
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 11px;
        font-weight: 600;
        flex-shrink: 0;
      }
      .user-info {
        flex: 1;
        min-width: 0;
      }
      .user-name {
        font-size: 12px;
        font-weight: 500;
        color: hsl(var(--sidebar-foreground));
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .user-org {
        font-size: 11px;
        color: hsl(var(--muted-foreground));
        margin-top: 1px;
        display: flex;
        align-items: center;
        gap: 4px;
      }
      .user-org .admin-badge {
        font-size: 9px;
        color: hsl(var(--primary));
        font-weight: 600;
      }
      .user-chevrons {
        width: 14px;
        height: 14px;
        color: hsl(var(--muted-foreground));
        flex-shrink: 0;
        opacity: 0.5;
      }

      /* ── Main area ── */
      .main {
        flex: 1;
        background: hsl(var(--background));
        color: hsl(var(--foreground));
        overflow-y: auto;
        padding: 24px;
      }

      .main-header h1 {
        font-family: 'Oxanium', sans-serif;
        font-size: 18px;
        font-weight: 600;
        color: hsl(var(--foreground));
      }
      .main-header .subtitle {
        font-size: 12px;
        color: hsl(var(--muted-foreground));
        margin-top: 2px;
      }

      /* ── Settings tabs ── */
      .settings-tabs {
        display: flex;
        gap: 0;
        margin-top: 20px;
        border-bottom: 1px solid hsl(var(--border));
        overflow-x: auto;
      }
      .tab {
        font-family: 'Inter', sans-serif;
        font-size: 13px;
        font-weight: 500;
        padding: 10px 16px;
        color: hsl(var(--muted-foreground));
        cursor: pointer;
        border-bottom: 2px solid transparent;
        transition: all 0.15s;
        white-space: nowrap;
        background: none;
        border-top: none;
        border-left: none;
        border-right: none;
      }
      .tab:hover {
        color: hsl(var(--foreground));
      }
      .tab.active {
        color: hsl(var(--foreground));
        border-bottom-color: hsl(var(--primary));
      }

      /* ── Tab content area ── */
      .tab-content {
        max-width: 600px;
        margin-top: 24px;
      }

      /* ── Panel header ── */
      .panel-header h2 {
        font-family: 'Oxanium', sans-serif;
        font-size: 16px;
        font-weight: 600;
        color: hsl(var(--foreground));
      }
      .panel-header .subtext {
        font-size: 12px;
        color: hsl(var(--muted-foreground));
        margin-top: 4px;
      }

      /* ── Day cards ── */
      .day-cards {
        display: flex;
        flex-direction: column;
        gap: 4px;
        margin-top: 16px;
      }

      .day-card {
        border-radius: 8px;
        background: hsl(var(--muted) / 0.3);
        border: 1px solid hsl(var(--border));
        overflow: hidden;
        transition: all 0.2s ease;
      }
      .day-card:hover:not(.expanded) {
        background: hsl(var(--muted) / 0.5);
      }
      .day-card.expanded {
        border-color: hsl(var(--primary) / 0.3);
        box-shadow: 0 0 0 1px hsl(var(--primary) / 0.1);
      }

      /* Collapsed row */
      .day-collapsed {
        display: flex;
        align-items: center;
        padding: 12px 16px;
        cursor: pointer;
        gap: 12px;
        user-select: none;
      }
      .day-name {
        font-family: 'Oxanium', sans-serif;
        font-size: 13px;
        font-weight: 500;
        color: hsl(var(--foreground));
        width: 40px;
        flex-shrink: 0;
      }
      .day-card.day-off .day-name {
        color: hsl(var(--muted-foreground));
      }
      .day-time-range {
        flex: 1;
        font-size: 13px;
        color: hsl(var(--foreground));
        font-variant-numeric: tabular-nums;
      }
      .day-card.day-off .day-time-range {
        color: hsl(var(--muted-foreground));
        font-style: italic;
        font-size: 12px;
      }
      .hours-badge {
        font-family: 'Oxanium', sans-serif;
        font-size: 11px;
        font-weight: 600;
        padding: 2px 8px;
        border-radius: 99px;
        background: hsl(var(--primary) / 0.1);
        color: hsl(var(--primary));
        flex-shrink: 0;
      }
      .day-card.day-off .hours-badge {
        background: transparent;
        color: hsl(var(--muted-foreground));
        opacity: 0.5;
      }
      .day-chevron {
        width: 16px;
        height: 16px;
        color: hsl(var(--muted-foreground));
        flex-shrink: 0;
        transition: transform 0.2s ease;
      }
      .day-card.expanded .day-chevron {
        transform: rotate(180deg);
      }

      /* Expanded content */
      .day-expanded {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease;
      }
      .day-card.expanded .day-expanded {
        max-height: 300px;
      }
      .day-expanded-inner {
        padding: 0 16px 16px;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
      .day-expanded-divider {
        height: 1px;
        background: hsl(var(--border));
      }

      /* Time inputs row */
      .time-inputs-row {
        display: flex;
        align-items: center;
        gap: 12px;
      }
      .time-input-group {
        display: flex;
        flex-direction: column;
        gap: 4px;
        flex: 1;
      }
      .time-input-group label {
        font-size: 10px;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: hsl(var(--muted-foreground));
        font-weight: 500;
      }
      .time-input-group input[type='time'] {
        background: hsl(var(--muted));
        border: 1px solid hsl(var(--border));
        border-radius: 6px;
        padding: 8px 10px;
        font-family: 'Oxanium', sans-serif;
        font-size: 14px;
        color: hsl(var(--foreground));
        outline: none;
        transition: border-color 0.15s;
        width: 100%;
      }
      .time-input-group input[type='time']:focus {
        border-color: hsl(var(--primary));
      }
      .time-input-group input[type='time']:disabled {
        opacity: 0.4;
        cursor: not-allowed;
      }
      .time-separator {
        font-size: 16px;
        color: hsl(var(--muted-foreground));
        margin-top: 18px;
      }
      .hours-calculated {
        font-family: 'Oxanium', sans-serif;
        font-size: 20px;
        font-weight: 600;
        color: hsl(var(--primary));
        margin-top: 18px;
        text-align: center;
        min-width: 48px;
        flex-shrink: 0;
      }

      /* Toggle row */
      .toggle-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
      }
      .toggle-row span {
        font-size: 13px;
        color: hsl(var(--foreground));
      }
      .toggle-switch {
        position: relative;
        width: 36px;
        height: 20px;
        background: hsl(var(--muted));
        border: 1px solid hsl(var(--border));
        border-radius: 99px;
        cursor: pointer;
        transition: all 0.2s;
        flex-shrink: 0;
      }
      .toggle-switch.active {
        background: hsl(var(--primary));
        border-color: hsl(var(--primary));
      }
      .toggle-switch::after {
        content: '';
        position: absolute;
        top: 2px;
        left: 2px;
        width: 14px;
        height: 14px;
        background: hsl(var(--foreground));
        border-radius: 50%;
        transition: transform 0.2s;
      }
      .toggle-switch.active::after {
        transform: translateX(16px);
        background: hsl(var(--background));
      }

      /* Copy actions */
      .copy-actions {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }
      .copy-pill {
        font-family: 'Inter', sans-serif;
        font-size: 11px;
        padding: 5px 12px;
        border-radius: 6px;
        border: 1px solid hsl(var(--border));
        background: hsl(var(--muted));
        color: hsl(var(--muted-foreground));
        cursor: pointer;
        transition: all 0.15s;
        display: flex;
        align-items: center;
        gap: 5px;
      }
      .copy-pill:hover {
        border-color: hsl(var(--primary) / 0.4);
        color: hsl(var(--primary));
        background: hsl(var(--primary) / 0.06);
      }
      .copy-pill i {
        width: 12px;
        height: 12px;
      }

      /* ── Weekly summary ── */
      .weekly-summary {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        padding: 12px 16px;
        margin-top: 4px;
        background: hsl(var(--t-stat-bg));
        border: 1px solid hsl(var(--border));
        border-radius: 8px;
      }
      .weekly-summary span {
        font-family: 'Oxanium', sans-serif;
        font-size: 13px;
        color: hsl(var(--muted-foreground));
      }
      .weekly-summary .total {
        font-weight: 600;
        color: hsl(var(--foreground));
      }
      .weekly-summary .dot {
        width: 3px;
        height: 3px;
        border-radius: 50%;
        background: hsl(var(--muted-foreground));
        opacity: 0.4;
      }

      /* ── Effective date ── */
      .effective-date {
        text-align: center;
        font-size: 11px;
        color: hsl(var(--muted-foreground));
        margin-top: 12px;
        opacity: 0.7;
      }

      /* ── Toast notification ── */
      .toast {
        position: fixed;
        bottom: 24px;
        left: 50%;
        transform: translateX(-50%) translateY(80px);
        background: hsl(var(--primary));
        color: hsl(var(--primary-foreground));
        font-family: 'Inter', sans-serif;
        font-size: 13px;
        font-weight: 500;
        padding: 10px 20px;
        border-radius: 8px;
        opacity: 0;
        transition: all 0.3s ease;
        pointer-events: none;
        z-index: 200;
        display: flex;
        align-items: center;
        gap: 6px;
      }
      .toast i {
        width: 14px;
        height: 14px;
      }
      .toast.show {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
    </style>
  </head>
  <body>
    <!-- Theme switcher bar -->
    <div class="theme-bar">
      <button class="active" onclick="setTheme('ternity-dark')">Ternity Dark</button>
      <button onclick="setTheme('ternity-light')">Ternity Light</button>
      <button onclick="setTheme('midnight')">Midnight</button>
      <button onclick="setTheme('warm-sand')">Warm Sand</button>
      <button onclick="setTheme('carbon')">Carbon</button>
      <button onclick="setTheme('high-contrast')">High Contrast</button>
    </div>

    <div id="app" data-theme="ternity-dark">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="logo">
          <svg
            class="logo-icon"
            viewBox="0 0 18 22"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
          >
            <path
              d="M9 1v5M5 3.5h8M3 6h12a1 1 0 011 1v9a5 5 0 01-5 5H7a5 5 0 01-5-5V7a1 1 0 011-1z"
            />
            <path d="M6 10v4M9 9v5M12 10v4" stroke-linecap="round" />
          </svg>
          <span class="logo-text">Ternity</span>
        </div>

        <div class="section-label">Tracking</div>
        <a class="nav-item"><i data-lucide="timer"></i> My Day</a>
        <a class="nav-item"><i data-lucide="list"></i> Entries</a>
        <a class="nav-item"><i data-lucide="calendar"></i> Calendar</a>
        <a class="nav-item"><i data-lucide="palmtree"></i> Leave</a>
        <a class="nav-item"><i data-lucide="bar-chart-3"></i> Reports</a>

        <div class="sidebar-spacer"></div>

        <div class="user-block">
          <div class="avatar">PR</div>
          <div class="user-info">
            <div class="user-name">Przemyslaw R.</div>
            <div class="user-org">
              Netbulls
              <span class="admin-badge">Admin</span>
            </div>
          </div>
          <i data-lucide="chevrons-up-down" class="user-chevrons"></i>
        </div>
      </aside>

      <!-- Main content -->
      <main class="main">
        <div class="main-header">
          <h1>Settings</h1>
          <p class="subtitle">Manage your account preferences</p>
        </div>

        <!-- Settings tabs -->
        <div class="settings-tabs">
          <button class="tab">General</button>
          <button class="tab">Appearance</button>
          <button class="tab">Integrations</button>
          <button class="tab">Downloads</button>
          <button class="tab">Tags</button>
          <button class="tab active">Working Hours</button>
          <button class="tab">Notifications</button>
        </div>

        <!-- Working Hours content -->
        <div class="tab-content">
          <div class="panel-header">
            <h2>Weekly Schedule</h2>
            <p class="subtext">Tap a day to edit</p>
          </div>

          <div class="day-cards" id="dayCards">
            <!-- Generated by JS -->
          </div>

          <div class="weekly-summary" id="weeklySummary">
            <span class="total" id="weeklyTotal">40h</span>
            <span>/week</span>
            <div class="dot"></div>
            <span id="weeklyDays">5 days</span>
          </div>

          <div class="effective-date">Effective since 3 Feb 2026</div>
        </div>
      </main>
    </div>

    <div class="toast" id="toast"><i data-lucide="check"></i> <span id="toastMsg">Saved</span></div>

    <script>
      // Day data
      const days = [
        { key: 'mon', name: 'Mon', start: '09:00', end: '17:00', off: false },
        { key: 'tue', name: 'Tue', start: '09:00', end: '17:00', off: false },
        { key: 'wed', name: 'Wed', start: '09:00', end: '17:00', off: false },
        { key: 'thu', name: 'Thu', start: '09:00', end: '17:00', off: false },
        { key: 'fri', name: 'Fri', start: '09:00', end: '17:00', off: false },
        { key: 'sat', name: 'Sat', start: '09:00', end: '17:00', off: true },
        { key: 'sun', name: 'Sun', start: '09:00', end: '17:00', off: true },
      ];

      let expandedDay = null;

      function calcHours(start, end) {
        const [sh, sm] = start.split(':').map(Number);
        const [eh, em] = end.split(':').map(Number);
        const diff = (eh * 60 + em - (sh * 60 + sm)) / 60;
        return Math.max(0, diff);
      }

      function formatHours(h) {
        if (h === 0) return '0h';
        const whole = Math.floor(h);
        const frac = h - whole;
        if (frac === 0) return whole + 'h';
        return whole + 'h ' + Math.round(frac * 60) + 'm';
      }

      function formatTimeRange(start, end) {
        return start + ' \u2013 ' + end;
      }

      function updateWeeklySummary() {
        let totalHours = 0;
        let workDays = 0;
        days.forEach((d) => {
          if (!d.off) {
            totalHours += calcHours(d.start, d.end);
            workDays++;
          }
        });
        document.getElementById('weeklyTotal').textContent = formatHours(totalHours);
        document.getElementById('weeklyDays').textContent =
          workDays + ' day' + (workDays !== 1 ? 's' : '');
      }

      function toggleDay(key) {
        if (expandedDay === key) {
          expandedDay = null;
        } else {
          expandedDay = key;
        }
        renderCards();
      }

      function toggleDayOff(key) {
        const day = days.find((d) => d.key === key);
        day.off = !day.off;
        renderCards();
        updateWeeklySummary();
        showToast('Saved');
      }

      function updateTime(key, field, value) {
        const day = days.find((d) => d.key === key);
        day[field] = value;
        // Update the hours display in the expanded card
        const hoursEl = document.getElementById('hours-calc-' + key);
        if (hoursEl) {
          hoursEl.textContent = formatHours(calcHours(day.start, day.end));
        }
        // Update collapsed row badge
        const badgeEl = document.getElementById('badge-' + key);
        if (badgeEl) {
          badgeEl.textContent = day.off ? '\u2014' : formatHours(calcHours(day.start, day.end));
        }
        // Update collapsed row time range
        const rangeEl = document.getElementById('range-' + key);
        if (rangeEl && !day.off) {
          rangeEl.textContent = formatTimeRange(day.start, day.end);
        }
        updateWeeklySummary();
        showToast('Saved');
      }

      function copyToWeekdays(key) {
        const source = days.find((d) => d.key === key);
        const weekdayKeys = ['mon', 'tue', 'wed', 'thu', 'fri'];
        weekdayKeys.forEach((wk) => {
          const d = days.find((dd) => dd.key === wk);
          d.start = source.start;
          d.end = source.end;
          d.off = false;
        });
        renderCards();
        updateWeeklySummary();
        showToast('Copied to all weekdays');
      }

      function copyToAll(key) {
        const source = days.find((d) => d.key === key);
        days.forEach((d) => {
          d.start = source.start;
          d.end = source.end;
          d.off = false;
        });
        renderCards();
        updateWeeklySummary();
        showToast('Copied to all days');
      }

      function showToast(msg) {
        const toast = document.getElementById('toast');
        document.getElementById('toastMsg').textContent = msg;
        toast.classList.add('show');
        clearTimeout(toast._timer);
        toast._timer = setTimeout(() => toast.classList.remove('show'), 2000);
      }

      function renderCards() {
        const container = document.getElementById('dayCards');
        container.innerHTML = '';

        days.forEach((day) => {
          const isExpanded = expandedDay === day.key;
          const hours = calcHours(day.start, day.end);

          const card = document.createElement('div');
          card.className =
            'day-card' + (day.off ? ' day-off' : '') + (isExpanded ? ' expanded' : '');

          // Collapsed row
          const collapsed = document.createElement('div');
          collapsed.className = 'day-collapsed';
          collapsed.onclick = () => toggleDay(day.key);

          collapsed.innerHTML =
            '<span class="day-name">' +
            day.name +
            '</span>' +
            '<span class="day-time-range" id="range-' +
            day.key +
            '">' +
            (day.off ? 'Day off' : formatTimeRange(day.start, day.end)) +
            '</span>' +
            '<span class="hours-badge" id="badge-' +
            day.key +
            '">' +
            (day.off ? '\u2014' : formatHours(hours)) +
            '</span>' +
            '<i data-lucide="chevron-down" class="day-chevron"></i>';

          card.appendChild(collapsed);

          // Expanded content
          const expanded = document.createElement('div');
          expanded.className = 'day-expanded';

          const inner = document.createElement('div');
          inner.className = 'day-expanded-inner';

          inner.innerHTML =
            '<div class="day-expanded-divider"></div>' +
            // Time inputs
            '<div class="time-inputs-row">' +
            '<div class="time-input-group">' +
            '<label>Start</label>' +
            '<input type="time" value="' +
            day.start +
            '" ' +
            'onchange="updateTime(\'' +
            day.key +
            "', 'start', this.value)\" " +
            (day.off ? 'disabled' : '') +
            ' />' +
            '</div>' +
            '<span class="time-separator">\u2192</span>' +
            '<div class="time-input-group">' +
            '<label>End</label>' +
            '<input type="time" value="' +
            day.end +
            '" ' +
            'onchange="updateTime(\'' +
            day.key +
            "', 'end', this.value)\" " +
            (day.off ? 'disabled' : '') +
            ' />' +
            '</div>' +
            '<div class="hours-calculated" id="hours-calc-' +
            day.key +
            '">' +
            (day.off ? '\u2014' : formatHours(hours)) +
            '</div>' +
            '</div>' +
            // Day off toggle
            '<div class="toggle-row">' +
            '<span>Mark as day off</span>' +
            '<div class="toggle-switch' +
            (day.off ? ' active' : '') +
            '" ' +
            'onclick="toggleDayOff(\'' +
            day.key +
            '\')"></div>' +
            '</div>' +
            // Copy actions
            '<div class="copy-actions">' +
            '<button class="copy-pill" onclick="copyToWeekdays(\'' +
            day.key +
            '\')">' +
            '<i data-lucide="copy"></i> All weekdays' +
            '</button>' +
            '<button class="copy-pill" onclick="copyToAll(\'' +
            day.key +
            '\')">' +
            '<i data-lucide="copy"></i> All days' +
            '</button>' +
            '</div>';

          expanded.appendChild(inner);
          card.appendChild(expanded);
          container.appendChild(card);
        });

        lucide.createIcons();
      }

      // Theme switcher
      function setTheme(t) {
        document.getElementById('app').setAttribute('data-theme', t);
        document.querySelectorAll('.theme-bar button').forEach((b) => b.classList.remove('active'));
        event.target.classList.add('active');
      }

      // Init
      renderCards();
      updateWeeklySummary();
      lucide.createIcons();
    </script>
  </body>
</html>
